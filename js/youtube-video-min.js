(function(){function d(c,d){function r(){var c=!1,d="";$.each(j,function(e,f){var g=f.id,i=f.type,l=f.loadTypeIndex,m=f.addedToList;if("video"!=i||m){if("playlist"==i&&!m)return d=b+"/"+g+"?max-results=0",$.ajax({url:d,dataType:"jsonp",data:h,success:function(a){s(a,i,g,l)}}),j[e].addedToList=!0,c=!0,!1;if("search"==i&&!m)return d=a+"?q="+g+"&max-results=0",$.ajax({url:d,dataType:"jsonp",data:h,success:function(a){s(a,i,g)}}),j[e].addedToList=!0,c=!0,!1}else k.push({type:"video",id:g,feed:null,ytFeed:null,loadTypeIndex:l}),j[e].addedToList=!0}),c||(m=!0,l&&v(l),l=null,"function"==typeof i.onComplete&&i.onComplete(k.length))}function s(a,b,c,d){for(var e=p=a.feed.openSearch$totalResults.$t,f=0;e>f;f++)k.push({type:b,id:c,feed:null,ytFeed:null,loadTypeIndex:d,startIndex:f+1});r()}function t(a,b,c,d){"video"==b?(o[d].ytFeed=a,o[d].feed=w(a.entry)):("playlist"==b||"search"==b)&&$.each(a.feed.entry,function(a,b){var c=w(b);c?(o[d].ytFeed=b,o[d].feed=c,d++):o.pop()}),u()}function u(){var c=!1,d=0,e=0,i=1,j="";o.length;var l=-1;$.each(o,function(f,g){var k=g.id,m=g.feed,n=g.type,p=g.loadTypeIndex;if(!m&&"video"==n)return j=a+"/"+k,$.ajax({url:j,dataType:"jsonp",data:h,success:function(a){t(a,n,k,f)}}),c=!0,!1;if(!m&&("playlist"==n||"search"==n)){l!=p&&(d=f,l=p,e=g.startIndex);var q=o[f+1]?o[f+1].loadTypeIndex:-2;if(-1!=l&&l!=q)return"playlist"==n?j=b+"/"+k+"?max-results="+i+"&start-index="+e:"search"==n&&(j=a+"?q="+k+"&max-results="+i+"&start-index="+e),$.ajax({url:j,dataType:"jsonp",data:h,success:function(a){t(a,n,k,d)}}),c=!0,!1;l==p&&i++}}),c||n(o)}function v(a){if(l=null,m){a.startIndex&&(g=a.startIndex),a.itemPerPage&&(f=a.itemPerPage),n=a.onComplete;var b=g+f;b>=k.length&&(b=k.length),o=k.slice(g,b),u()}else l=a}function w(a){var b={};try{b.title=a.title.$t,b.videoId=a.media$group.yt$videoid.$t,b.thumbUrl=a.media$group.media$thumbnail["0"].url,b.mqImg=a.media$group.media$thumbnail["1"].url,b.hqImg=a.media$group.media$thumbnail["2"].url,b.sdImg=a.media$group.media$thumbnail["3"].url,b.maxResImg="http://i.ytimg.com/vi/"+b.videoId+"/maxresdefault.jpg",b.seconds=a.media$group.yt$duration.seconds,b.favoriteCount=a.yt$statistics.favoriteCount,b.viewCount=a.yt$statistics.viewCount,b.numDislikes=a.yt$rating?a.yt$rating.numDislikes:0,b.numLikes=a.yt$rating?a.yt$rating.numLikes:0,b.author=a.author["0"].name.$t,b.thumbUrl1=a.media$group.media$thumbnail["4"].url,b.thumbUrl2=a.media$group.media$thumbnail["5"].url}catch(c){b=null}return b}function x(){h=i.ytVars?_var.ytVars:{},h.safeSearch||(h.safeSearch="none"),h.orderBy||(h.orderBy="relevance"),h.v=2,h.alt="json"}var f,g,h,i,l,n,p,j=[],k=[],m=!1,o=[];i=d?d:{},x(),f=i.itemPerPage?i.itemPerPage:5,g=i.startIndex?i.startIndex:1;var q=c.split(",");return j=[],$.each(q,function(a,b){var c=e(b).v,d=e(b).list;c?j.push({id:c,type:"video",addedToList:!1,loadTypeIndex:a}):d?j.push({id:d,type:"playlist",addedToList:!1,loadTypeIndex:a}):(b=(""+b).replace(/\?/g,"&"),j.push({id:b,type:"search",addedToList:!1,loadTypeIndex:a}))}),k.push({}),r(),{getFeed:v,getTotalResults:function(){return p}}}function e(a){for(var b=a.substring(a.indexOf("?")+1),c={},d=b.split("&"),e=d.length;e--;){var f=d[e],g=f.substring(0,f.indexOf("="));c[g]=f.substring(f.indexOf("=")+1)}return c}var a="http://gdata.youtube.com/feeds/api/videos",b="http://gdata.youtube.com/feeds/api/playlists",c=window.oyejs?window.oyejs:{};c.YtDataLoader=d,window.oyejs=c})();